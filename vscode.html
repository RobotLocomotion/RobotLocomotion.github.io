<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="msapplication-config" content="/browserconfig.xml"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta charset="utf-8"/>
    <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png"/>
    <link rel="manifest" type="application/manifest+json" href="/site.webmanifest"/>
    <link rel="mask-icon" type="image/svg+xml" href="/mask-icon.svg" color="#990000"/>
    <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
    <title>Drake: VS Code IDE setup</title>
    <meta
      name="description"
      content="Drake (&quot;dragon&quot; in Middle English) is a C++ toolbox started by the Robot
Locomotion Group at the MIT Computer Science and Artificial Intelligence
Lab (CSAIL). The development team has now grown significantly, with core
development led by the Toyota Research Institute. It is a collection of
tools for analyzing the dynamics of our robots and building control
systems for them, with a heavy emphasis on optimization-based design/
analysis.
"/>
    <!--
    The "Work Sans" font is licensed under the SIL Open Font License (OFL). For
    more information, see:
    - https://fonts.google.com/specimen/Work+Sans?preview.text_type=custom#about
    - https://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=OFL
    -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Work+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="/third_party/github-styling/github-markdown.css"/>
    <link rel="stylesheet" href="/third_party/dracula/syntax.css"/>
    <link rel="stylesheet" href="/third_party/pylons/pylons.css"/>
    <link rel="stylesheet" href="/assets/css/main.css"/>
  </head>
  <body>
    <header class="site-header">
  <div class="site-header-inner contain">
    <a href="/" class="drake-logo">
      <img src="/images/drake-logo-white.svg">
    </a>
    <div class="menu-mobile-toggle">
      <span></span>
    </div>
    <nav class="site-menu">
      <ul>
        
        <li class="site-menu-item site-menu-item-main">
          <a href="/" class="site-menu-item">Home</a>

          
        </li>
        
        <li class="site-menu-item site-menu-item-main">
          Installation

          
            <div class="sub">
            
              <a href="/installation.html" class="site-menu-item">Overview</a>
            
              <a href="/pip.html" class="site-menu-item">Pip</a>
            
              <a href="/apt.html" class="site-menu-item">APT</a>
            
              <a href="/from_binary.html" class="site-menu-item">Binary Download</a>
            
              <a href="/docker.html" class="site-menu-item">Docker Hub</a>
            
              <a href="/from_source.html" class="site-menu-item">Build From Source</a>
            
            </div>
          
        </li>
        
        <li class="site-menu-item site-menu-item-main">
          <a href="/gallery.html" class="site-menu-item">Gallery</a>

          
        </li>
        
        <li class="site-menu-item site-menu-item-main">
          API Documentation

          
            <div class="sub">
            
              <a href="/doxygen_cxx/index.html" class="site-menu-item">C++</a>
            
              <a href="/pydrake/index.html" class="site-menu-item">Python</a>
            
            </div>
          
        </li>
        
        <li class="site-menu-item site-menu-item-main">
          Resources

          
            <div class="sub">
            
              <a href="/getting_help.html" class="site-menu-item">Getting Help</a>
            
              <a href="https://deepnote.com/workspace/Drake-0b3b2c53-a7ad-441b-80f8-bf8350752305/project/Tutorials-2b4fc509-aef2-417d-a40d-6071dfed9199/%2Findex.ipynb" class="site-menu-item">Tutorials</a>
            
              <a href="/troubleshooting.html" class="site-menu-item">Troubleshooting</a>
            
              <a href="/python_bindings.html" class="site-menu-item">Python Bindings</a>
            
              <a href="/developers.html" class="site-menu-item">For Developers</a>
            
              <a href="/credits.html" class="site-menu-item">Credits</a>
            
            </div>
          
        </li>
        

        <li class="search">
          <div class="search-icon">
              <!-- This is an inline SVG image of a magnifying glass. -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 374.9 374.84">
              <path d="M235 270a148.74 148.74 0 1 1 35-35l97.74 97.74a24.37 24.37 0 0 1 0 34.58l-.4.4a24.47 24.47 0 0 1-34.58 0L235 270Zm-86.22-7.47A113.75 113.75 0 1 0 35 148.75 113.75 113.75 0 0 0 148.75 262.5Z"/>
            </svg>
          </div>
          <div class="search-bar">
            <form id="search_form" action="https://google.com/search" method="get">
              <input type="text" name="q" placeholder="Search all of Drake…" />
              <input type="hidden" name="q" value="site:drake.mit.edu OR site:underactuated.csail.mit.edu OR site:manipulation.csail.mit.edu" />
            </form>
            <div class="search-close">
              <!-- This is an inline SVG image of an "X". -->
              <svg height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 373.61 373.57">
                <path d="M219.71 186.77 366.71 40a23.43 23.43 0 1 0-33.13-33.13l-146.77 147-146.77-147A23.43 23.43 0 0 0 6.9 40l147 146.77-147 146.77a23.43 23.43 0 1 0 33.14 33.13l146.77-147 146.77 147a23.43 23.43 0 1 0 33.13-33.13Z"/>
              </svg>
            </div>
          </div>
          <ul id="results-container"></ul>
        </li>

        <li class="github-link">
          <a href="https://github.com/RobotLocomotion/drake" class="site-menu-item">GitHub <img src="/third_party/images/GitHub-Mark-Light-64px.png" /></a>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="page">
      <div class="content">
        <div class="drake-page">
  <header class="drake-page-header">
    <div class="contain">
      <h1>VS Code IDE setup</h1>
    </div>
  </header>
  <section class="padding">
    <div class="contain">
      <article class="markdown-body">
        <p>This guide describes how to edit the Drake codebase using VS Code.</p>

<p>If you have tips that would help out other developers, drop us a line and we
can add them here!</p>

<h1 id="setting-up-vs-code">Setting up VS Code</h1>

<p>There is nothing really special to do.
Be sure you’ve installed the C/C++ extension pack from Microsoft.</p>

<h2 id="c-paths">C++ paths</h2>

<p>Because VS Code wants to locate all included headers, but Bazel does
not provide those headers in a single consistent location, it is
common to get “red squiggles” for included headers, particularly for
externals like LCM.  So far this does not seem to be avoidable; the
<code class="language-plaintext highlighter-rouge">"C_Cpp.errorSquiggles": "enabledIfIncludesResolve"</code> setting does not
work to solve this problem.</p>

<h2 id="c-code-formatting">C++ code formatting</h2>

<p>The <a href="https://code.visualstudio.com/docs/cpp/cpp-ide#_code-formatting">Visual Studio docs</a>
on code formatting work well. Take note of “Format Document”,
“Format Selection”, “Format on save”, and “Format on type”.</p>

<p>In the VS Code Options configuration, check that the option for
<code class="language-plaintext highlighter-rouge">C_Cpp: Clang_format_path</code> is set to Drake’s preferred value
<code class="language-plaintext highlighter-rouge">/path/to/drake/bazel-bin/tools/lint/clang-format</code>.</p>

<h2 id="c-code-semantic-analysis--autocompletion">C++ code semantic analysis / autocompletion</h2>
<p>VScode relies on the language server <code class="language-plaintext highlighter-rouge">clangd</code> and the json file <a href="https://clang.llvm.org/docs/JSONCompilationDatabase.html">compile_commands.json</a> for code semantic analysis / autocompletion. To enable this feature, take the following steps</p>
<ol>
  <li>Install <code class="language-plaintext highlighter-rouge">clangd</code> on your system.
On Ubuntu, do
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt install clangd
</code></pre></div>    </div>
    <p>On mac, do</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install llvm
</code></pre></div>    </div>
  </li>
  <li>In VSCode, add <code class="language-plaintext highlighter-rouge">clangd</code> extension. If you have IntelliSense, disable it through
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// .vscode/settings.json
{
  "C_Cpp.intelliSenseEngine": "disabled"
}
</code></pre></div>    </div>
  </li>
  <li>To generate <code class="language-plaintext highlighter-rouge">compile_commands.json</code> file, take the following steps
    <ul>
      <li>Checkout this <a href="https://github.com/hongkai-dai/bazel-compile-commands-extractor/tree/enable_drake">branch</a> of <code class="language-plaintext highlighter-rouge">bazel-compile-commands-extractor</code> (the upstream version doesn’t work with Drake)
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ git clone git@github.com:hongkai-dai/bazel-compile-commands-extractor.git
 $ git checkout enable_drake
</code></pre></div>        </div>
      </li>
      <li>Then add this to your <code class="language-plaintext highlighter-rouge">drake/user.bazelrc</code>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> common --inject_repository=hedron_compile_commands=PATH_TO_BAZEL_COMPILE_COMMANDS_EXTRACTOR
</code></pre></div>        </div>
        <p>where <code class="language-plaintext highlighter-rouge">PATH_TO_BAZEL_COMPILE_COMMANDS_EXTRACTOR</code> is the directory where you checked out <code class="language-plaintext highlighter-rouge">bazel-compile-commands-extractor</code>.</p>
      </li>
      <li>In <code class="language-plaintext highlighter-rouge">drake</code> folder, run
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ bazel run @hedron_compile_commands//:refresh_all
</code></pre></div>        </div>
        <p>You should see a <code class="language-plaintext highlighter-rouge">compile_commands.json</code> file in your <code class="language-plaintext highlighter-rouge">drake</code> folder.
 Note: this command might take a while (like 5 mins) to run. You probably will see some error messages like</p>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> bazel-out/k8-opt/bin/external/+internal_repositories+fcl_internal/drake_hdr/fcl/common/types.h:130:27: error: missing binary operator before token "("
 130 | #if EIGEN_VERSION_AT_LEAST(3,2,9)
</code></pre></div>        </div>
        <p>you can ignore these error messages.</p>
      </li>
    </ul>
  </li>
  <li>In VSCode, you should see that you can go to the definition of any C++ object, and the autocompletion is semantic-based.</li>
  <li>Everytime Drake Bazel build files (including <code class="language-plaintext highlighter-rouge">BUILD.bazel</code>) are changed, you will need to rerun <code class="language-plaintext highlighter-rouge">bazel run @hedron_compile_commands//:refresh_all</code> to update the <code class="language-plaintext highlighter-rouge">compilation_commands.json</code> file.</li>
</ol>

<p>These instructions are adapted from <a href="https://github.com/hedronvision/bazel-compile-commands-extractor">Hedronvision’s bazel-compile-commands-extractor</a> project.</p>

      </article>
    </div>
  </section>
</div>

        <footer class="site-footer padding">
  <div class="contain">
    <a href="/" class="drake-logo">
      <img src="/images/drake-logo.svg">
    </a>
    <div class="footer-menu">
      <ul>
        
        <li>
          <a href="/doxygen_cxx/index.html" class="site-menu-item">C++</a>
        </li>
        
        <li>
          <a href="/pydrake/index.html" class="site-menu-item">Python</a>
        </li>
        

        <li class="github-link">
          <a href="https://github.com/RobotLocomotion/drake" class="site-menu-item">GitHub <img src="/third_party/images/GitHub-Mark-64px.png" /></a>
        </li>
      </ul>
    </div>
  </div>

  <!-- TODO(eric.cousineau): Consider placing copyright here. -->

</footer>

      </div>
    </div>
    <script src="/assets/js/mobile.js"></script>
    <!-- Search -->
    <script src="/assets/js/search.js"></script>
  </body>
</html>
