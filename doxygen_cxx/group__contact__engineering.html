<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Drake: Working with Contacts in Drake</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Drake
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__contact__engineering.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Working with Contacts in Drake<div class="ingroups"><a class="el" href="group__multibody.html">Multibody Kinematics and Dynamics</a> &raquo; <a class="el" href="group__drake__contacts.html">Contact Modeling in Drake</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>The behavior of a simulation with contact will depend on three factors: </p>
<ul>
<li>contact parameters,</li>
<li>the time advancement strategy,</li>
<li>nature of collision geometry.</li>
</ul>
<p>The three factors are interdependent; specific choices for one factor may require supporting changes in the other factors.</p>
<p><a class="anchor" id="contact_parameters"></a></p><h2>Contact Parameters</h2>
<p>Contact modeling in Drake is controlled by a small set of parameters:</p><ol type="1">
<li>Per-geometry coefficients of friction. Refer to the documentation for <a class="el" href="classdrake_1_1multibody_1_1_coulomb_friction.html">CoulombFriction</a> for details, which also includes a description for modeling the interaction between two surfaces with different coefficients of friction.</li>
<li>Global parameters controlling the stiffness of normal penalty forces. <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html">MultibodyPlant</a> offers a single global parameter, the "penetration allowance", described in detail in section <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html#mbp_penalty_method">Contact by penalty method</a>.</li>
<li>Global parameter controlling the Stribeck approximation of Coulomb friction, refer to section <a class="el" href="group__stribeck__approximation.html">Continuous Approximation of Coulomb</a> for details. <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html#a3ce165180ba1d40e2a120eea631e4cb1">set_stiction_tolerance()</a> provides additional information and guidelines on how to set this parameter.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>When modeling the multibody system as discrete (refer to the <a class="el" href="group__contact__engineering.html#time_advancement_strategy">Choice of Time Advancement Strategy</a> section), only the dynamic coefficient of friction is used while the static coefficient of friction is ignored.</dd></dl>
<p><a class="anchor" id="time_advancement_strategy"></a></p><h2>Choice of Time Advancement Strategy</h2>
<p><a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html">MultibodyPlant</a> offers two different modalities to model mechanical systems in time. These are:</p><ol type="1">
<li>As a discrete system with periodic updates (the preferred method for robustness and speed).</li>
<li>As a continuous system.</li>
</ol>
<p>In this section we'll only provide a very limited distinction between a continuous and a discrete system. A complete discussion of the subject, including the modeling of hybrid systems is beyond the scope of this section and thus the interested is referred to the documentation for <a class="el" href="classdrake_1_1systems_1_1_simulator.html">Simulator</a>.</p>
<h3>Discrete MultibodyPlant</h3>
<p>Currently, this is the preferred modality given its speed and robustness. In this modality, the system is updated through periodic updates of length <code>time_step</code>. This can essentially be seen as a time-stepping strategy with a fixed <code>time_step</code>. The value of <code>time_step</code> is provided at construction of the <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html">MultibodyPlant</a>. In Drake we use a custom semi-implicit Euler scheme, TAMSI, for multibody systems with regularized friction. Details for this solver are provided in the documentation for <a class="el" href="classdrake_1_1multibody_1_1_tamsi_solver.html">TamsiSolver</a> and in [Castro et al., 2019].</p>
<p>[Castro et al., 2019] Castro, A.M, Qu, A., Kuppuswamy, N., Alspach, A., Sherman, M.A., 2019. A Transition-Aware Method for the Simulation of Compliant Contact with Regularized Friction. arXiv:1909.05700 [cs.RO].</p>
<dl class="section note"><dt>Note</dt><dd>For better numerical stability, the discrete model assumes both static and kinetic coefficients of friction to be equal, the kinetic coefficient of friction is ignored.</dd></dl>
<h3>Continuous MultibodyPlant</h3>
<p>If the <code>time_step</code> defined above is specified to be exactly zero at <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html">MultibodyPlant</a> construction, the system is modeled as continuous. What that means is that the system is modeled to follow continuous dynamics of the form <code>ẋ = f(t, x, u)</code>, where <code>x</code> is the state of the plant, t is time, and u is the set of externally applied inputs (either actuation or external body forces). In this mode, any of Drake's integrators can be used to advance the system forward in time. The following text outlines the implications of using particular integrators.</p>
<p>Integrators can be broadly categorized as one of:</p><ol type="1">
<li>Implicit/Explicit integrators.</li>
<li>Fixed time step/error controlled integrators.</li>
</ol>
<p>While fixed time step integrators often provide faster simulations, they can miss slip/stick transitions when the stiction tolerance <code>vₛ</code> of the Stribeck approximation is small (say, smaller than 1e-3 m/s). In addition, they might suffer from stability problems when the penalty forces are made stiff (see <a class="el" href="classdrake_1_1multibody_1_1_multibody_plant.html#a8cdb3408c412b2af94476886dc35cc71">set_penetration_allowance()</a>).</p>
<p>Error controlled integrators such as <a class="el" href="classdrake_1_1systems_1_1_runge_kutta3_integrator.html">RungeKutta3Integrator</a> offer a stable integration scheme by adapting the time step to satisfy a pre-specified accuracy tolerance. However, this stability comes with the price of slower simulations given that often these integrators need to take very small time steps in order to resolve stiff contact dynamics. In addition, these integrators usually perform additional computations to estimate error bounds used to determine step size.</p>
<p>Implicit integrators have the potential to integrate stiff continuous systems forward in time using larger time steps and therefore reduce computational cost. Thus far, with our <a class="el" href="classdrake_1_1systems_1_1_implicit_euler_integrator.html">ImplicitEulerIntegrator</a> we have not observed this advantage for multibody systems using the Stribeck approximation.</p>
<p><a class="anchor" id="crafting_collision_geometry"></a></p><h2>Choosing the Right Collision Geometry</h2>
<p>The compliant point contact model only reports a single contact between bodies. More particularly, the contact is characterized by a single point. The point is associated with a characteristic area in the model (see above). This has two implications:</p>
<ul>
<li><p class="startli"><b>Surface-on-surface contacts</b></p>
<p class="startli">If the contact between bodies is better characterized as a surface instead of a point (such as one box lying on another), the contact point will</p><ul>
<li>not be guaranteed to be at the center of pressure, possibly inducing unrealistic torque, and</li>
<li>not be temporally coherent. This will lead to instability artifacts which can only be addressed through smaller time steps.</li>
</ul>
<p class="startli">Both of these issues can be addressed by changing the geometry that represent the body's contact surface. For some shapes (e.g., boxes), we can introduce two sets of collision elements: discrete "points" at the corners, and a box capturing the volume (see <code>block_for_pick_and_place.urdf</code> as an example). With this strategy, the contact "points" are actually small-radius spheres. The volume-capturing box should actually be inset from those spheres such that when the box is lying on a plane (such that the logical contact manifold would be a face), only the contact points make contact, providing reliable points of contact. However, for arbitrary configurations contact with the box will provide more general contact.</p>
</li>
</ul>
<p>Next topic: <a class="el" href="group__stribeck__approximation.html">Continuous Approximation of Coulomb</a> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15 -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.nl/">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a></li>
  </ul>
</div>
</body>
</html>
