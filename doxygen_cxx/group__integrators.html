<!-- HTML header for doxygen 1.15.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Drake: Integrators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<header class="site-header">
 <div class="site-header-inner contain">
  <a class="drake-logo" href="/"><img src="/images/drake-logo-white.svg"></a>
  <div class="menu-mobile-toggle">
   <span></span>
  </div>
  <nav class="site-menu">
   <ul>
    <li class="site-menu-item site-menu-item-main">
     <a class="site-menu-item" href="/">Home</a>
    </li>
    <li class="site-menu-item site-menu-item-main">
     <a class="site-menu-item" href="/installation.html">Installation</a>
    </li>
    <li class="site-menu-item site-menu-item-main">
     <a class="site-menu-item" href="/gallery.html">Gallery</a>
    </li>
    <li class="site-menu-item site-menu-item-main">API Documentation
     <div class="sub">
      <a class="site-menu-item" href="/doxygen_cxx/index.html">C++</a>
      <a class="site-menu-item" href="/pydrake/index.html">Python</a>
     </div>
    </li>
    <li class="site-menu-item site-menu-item-main">Resources
     <div class="sub">
      <a class="site-menu-item" href="/getting_help.html">Getting Help</a>
      <a class="site-menu-item" href="https://deepnote.com/workspace/Drake-0b3b2c53-a7ad-441b-80f8-bf8350752305/project/Tutorials-2b4fc509-aef2-417d-a40d-6071dfed9199/notebook/index-753e3c9d261247ba9f0eb1d7868c18c8">Tutorials</a>
      <a class="site-menu-item" href="/python_bindings.html">Python Bindings</a>
      <a class="site-menu-item" href="/developers.html">For Developers</a>
      <a class="site-menu-item" href="/credits.html">Credits</a>
     </div>
    </li>
    <li class="github-link">
     <a class="site-menu-item" href="https://github.com/RobotLocomotion/drake">GitHub <img src="/third_party/images/GitHub-Mark-Light-64px.png"></a>
    </li>
   </ul>
  </nav>
 </div>
</header>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Drake
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<div class="title-banner">
 <div class="title-banner__title">
  Drake C++ Documentation
 </div>
 <div id="DDGSearch">
  <form id="search_form_cpp" class="wy_form" action="https://google.com/search" method="get">
   <input type="text" name="q" placeholder="Search C++ API only…">
   <input type="hidden" name="q" value="site:drake.mit.edu/doxygen_cxx">
  </form>
  <form id="search_form" class="wy_form" action="https://google.com/search" method="get">
   <input type="text" name="q" placeholder="Search all of Drake…">
   <input type="hidden" name="q" value="site:drake.mit.edu OR site:underactuated.csail.mit.edu OR site:manipulation.csail.mit.edu">
  </form>
 </div>
 <div id="MSearchBoxContainer">
  <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__integrators.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Integrators <div class="ingroups"><a class="el" href="group__algorithms.html">Algorithms</a> &raquo; <a class="el" href="group__simulation.html">Simulation</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Apart from solving initial value problems, for which the integrator is a key component of a simulator, integrators can also be used to solve boundary value problems (via numerical methods like the Multiple Shooting Method) and trajectory optimization problems (via numerical methods like direct transcription). </p>
<p><a class="el" href="classdrake_1_1systems_1_1_integrator_base.html" title="An abstract class for an integrator for ODEs and DAEs as represented by a Drake System.">IntegratorBase</a> and its derivatives were developed primarily toward the former application (through <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#a02875acba81c8be7dd0c7a2ae89db212" title="(Internal use only) Integrates the system forward in time by a single step with step size subject to ...">IntegratorBase::IntegrateNoFurtherThanTime()</a> and the <a class="el" href="classdrake_1_1systems_1_1_simulator.html" title="A class for advancing the state of hybrid dynamic systems, represented by System&lt;T&gt; objects,...">Simulator</a> class). However, the <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html" title="An abstract class for an integrator for ODEs and DAEs as represented by a Drake System.">IntegratorBase</a> architecture was developed to support these ancillary applications as well using the <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#acb2ebec0fff763d592464afb49bffe13" title="Stepping function for integrators operating outside of Simulator that advances the continuous state e...">IntegratorBase::IntegrateWithMultipleStepsToTime()</a> and <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#a33ee182a7a34894a888a3bcd3dfd5674" title="Stepping function for integrators operating outside of Simulator that advances the continuous state u...">IntegratorBase::IntegrateWithSingleFixedStepToTime()</a> methods; the latter permits the caller to advance time using fixed steps in applications where variable stepping would be deleterious (e.g., direct transcription).</p>
<h1 class="doxsection"><a class="anchor" id="integrator-selection"></a>
Integrator selection</h1>
<p>A natural question for a user to ask of an integrator is: Which scheme (method) should be applied to a particular problem? The answer is whichever one most quickly computes the solution to the desired accuracy! Selecting an integration scheme for a particular problem is presently an artform. As examples of some selection criteria: multistep methods (none of which are currently implemented in Drake) generally work poorly when events (that require state reinitializations) are common, symplectic methods generally work well at maintaining stability for large integration steps, and stiff integrators are often best for computationally stiff systems. If ignorant as to the characteristics of a particular problem, it is often best to start with an explicit, Runge-Kutta type method. Statistics collected by the integrator can help diagnose performance issues and possibly point to the use of a different integration scheme.</p>
<p>Some systems are known to exhibit "computational stiffness", by which it is meant that (excessively) small integration steps are necessary for purposes of stability: in other words, steps must be taken smaller than that required to achieve a desired accuracy <em>over a particular interval</em>. Thus, the nature of computationally stiff problems is that the solution to the ODE is <em>smooth</em> in the interval of stiffness (in contrast, some problems possess such high frequency dynamics that very small steps are simply necessary to capture the solution accurately). Implicit integrators are the go-to approach for solving computationally stiff problems, but careful consideration is warranted. Implicit integrators typically require much more computation than non-implicit (explicit) integrators, stiffness might be an issue on only a very small time interval, and some problems might be only "moderately stiff". Put another way, applying an implicit integrator to a potentially stiff problem might not yield faster computation. The first chapter of [Hairer, 1996] illustrates the issues broached in this paragraph using various examples.</p>
<h1 class="doxsection"><a class="anchor" id="settings"></a>
Integrator settings</h1>
<p><a class="el" href="classdrake_1_1systems_1_1_integrator_base.html" title="An abstract class for an integrator for ODEs and DAEs as represented by a Drake System.">IntegratorBase</a> provides numerous settings and flags that can leverage problem-specific information to speed integration and/or improve integration accuracy. As an example, <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#ae878ce4cdab7a01165423d8a902df452" title="Sets the maximum step size that may be taken by this integrator.">IntegratorBase::set_maximum_step_size()</a> allows the user to prevent overly large integration steps (that integration error control alone might be insufficient to detect). As noted previously, <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html" title="An abstract class for an integrator for ODEs and DAEs as represented by a Drake System.">IntegratorBase</a> also collects a plethora of statistics that can be used to diagnose poor integration performance. For example, a large number of shrinkages due to <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#error-estimation-and-control">error control</a> could indicate that a system is computationally stiff. <b>Note that you might need to alter the default settings to obtain desired performance even though we have attempted to select reasonable defaults for many problems.</b></p>
<p>See settings for <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#integrator-accuracy">integrator-accuracy</a>, <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#integrator-maxstep">maximum step size</a>, <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#integrator-minstep">minimum step size</a>, and <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#weighting-state-errors">weighting state errors</a> for in-depth information about the various performance settings shared across integrators.</p>
<h1 class="doxsection"><a class="anchor" id="dense-sampling"></a>
Dense sampling (interpolation)</h1>
<p>For applications that require a more dense sampling of the system continuous state than what would be available through either fixed or error-controlled step integration (for a given accuracy), dense output support is available (through <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#a0cdd4796b7f98a09da058b9764f13b86" title="Starts dense integration, allocating a new dense output for this integrator to use.">IntegratorBase::StartDenseIntegration()</a> and <a class="el" href="classdrake_1_1systems_1_1_integrator_base.html#aec1b43d020ade4db105e454ec595c21e" title="Stops dense integration, yielding ownership of the current dense output to the caller.">IntegratorBase::StopDenseIntegration()</a> methods). The accuracy and performance of these outputs may vary with each integration scheme implementation.</p>
<h1 class="doxsection"><a class="anchor" id="references"></a>
References</h1>
<ul>
<li>[Hairer, 1996] E. Hairer and G. Wanner. Solving Ordinary Differential Equations II (Stiff and Differential-Algebraic Problems). Springer, 1996. </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:BogackiShampine3Integrator_3C_20T_20_3E" id="r_BogackiShampine3Integrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_bogacki_shampine3_integrator.html">BogackiShampine3Integrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A third-order, four-stage, first-same-as-last (FSAL) Runge-Kutta integrator with a second order error estimate.  <a href="classdrake_1_1systems_1_1_bogacki_shampine3_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:ExplicitEulerIntegrator_3C_20T_20_3E" id="r_ExplicitEulerIntegrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_explicit_euler_integrator.html">ExplicitEulerIntegrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A first-order, explicit Euler integrator.  <a href="classdrake_1_1systems_1_1_explicit_euler_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:ImplicitEulerIntegrator_3C_20T_20_3E" id="r_ImplicitEulerIntegrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_implicit_euler_integrator.html">ImplicitEulerIntegrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A first-order, fully implicit integrator with second order error estimation.  <a href="classdrake_1_1systems_1_1_implicit_euler_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:IntegratorBase_3C_20T_20_3E" id="r_IntegratorBase_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_integrator_base.html">IntegratorBase&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An abstract class for an integrator for ODEs and DAEs as represented by a Drake <a class="el" href="classdrake_1_1systems_1_1_system.html" title="Base class for all System functionality that is dependent on the templatized scalar type T for input,...">System</a>.  <a href="classdrake_1_1systems_1_1_integrator_base.html#details">More...</a><br /></td></tr>
<tr class="memitem:RadauIntegrator_3C_20T_2C_20num_5Fstages_20_3E" id="r_RadauIntegrator_3C_20T_2C_20num_5Fstages_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_radau_integrator.html">RadauIntegrator&lt; T, num_stages &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A selectable order (third- or first-order), fully implicit integrator with error estimation.  <a href="classdrake_1_1systems_1_1_radau_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:RungeKutta2Integrator_3C_20T_20_3E" id="r_RungeKutta2Integrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_runge_kutta2_integrator.html">RungeKutta2Integrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A second-order, explicit Runge Kutta integrator.  <a href="classdrake_1_1systems_1_1_runge_kutta2_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:RungeKutta3Integrator_3C_20T_20_3E" id="r_RungeKutta3Integrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_runge_kutta3_integrator.html">RungeKutta3Integrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A third-order Runge Kutta integrator with a third order error estimate.  <a href="classdrake_1_1systems_1_1_runge_kutta3_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:RungeKutta5Integrator_3C_20T_20_3E" id="r_RungeKutta5Integrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_runge_kutta5_integrator.html">RungeKutta5Integrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A fifth-order, seven-stage, first-same-as-last (FSAL) Runge Kutta integrator with a fifth order error estimate.  <a href="classdrake_1_1systems_1_1_runge_kutta5_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:SemiExplicitEulerIntegrator_3C_20T_20_3E" id="r_SemiExplicitEulerIntegrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_semi_explicit_euler_integrator.html">SemiExplicitEulerIntegrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A first-order, semi-explicit Euler integrator.  <a href="classdrake_1_1systems_1_1_semi_explicit_euler_integrator.html#details">More...</a><br /></td></tr>
<tr class="memitem:VelocityImplicitEulerIntegrator_3C_20T_20_3E" id="r_VelocityImplicitEulerIntegrator_3C_20T_20_3E"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdrake_1_1systems_1_1_velocity_implicit_euler_integrator.html">VelocityImplicitEulerIntegrator&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A first-order, fully implicit integrator optimized for second-order systems, with a second-order error estimate.  <a href="classdrake_1_1systems_1_1_velocity_implicit_euler_integrator.html#details">More...</a><br /></td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- footer -->
<div class="navpath">
  <ul>
  </ul>
</div>
<footer id="nav-path", class="site-footer padding">
  <div class="contain">
    <a href="/" class="drake-logo">
      <img src="/images/drake-logo.svg"/>
    </a>
    <div class="footer-menu">
      <ul>
        <li>
          <a href="https://accessibility.mit.edu/" class="site-menu-item">Accessibility</a>
        </li>
        <li>
          <a href="/doxygen_cxx/index.html" class="site-menu-item">C++</a>
        </li>
        <li>
          <a href="/pydrake/index.html" class="site-menu-item">Python</a>
        </li>
        <li class="github-link">
          <a href="https://github.com/RobotLocomotion/drake" class="site-menu-item">GitHub <img src="/third_party/images/GitHub-Mark-64px.png"/></a>
        </li>
      </ul>
    </div>
  </div>
</footer>
<script type="text/javascript">
searchBox.searchLabel = 'Go to name…';
searchBox.DOMSearchField().placeholder = searchBox.searchLabel;
searchBox.DOMSearchField().value = '';
</script>
</body>
</html>
